/**=================================================================================================================================
* Created By: Denson Zunga & Tawanda Madavo
* Created Date: 14/01/2021
* Description: Class to handle invoices callout mock responses
===================================================================================================================================**/
@isTest
global class Mock_GetInvoices implements HttpCalloutMock{
    global String responseType;
    global Mock_GetInvoices(String responseType){
        this.responseType = responseType;
    }

    global HTTPResponse respond(HTTPRequest request) {
            
        // Create a fake response
        HttpResponse response = new HttpResponse();
        response.setHeader('Content-Type','text/xml;charset=UTF-8');
        response.setHeader('Accept-Encoding','gzip,deflate');
        response.setHeader('SOAPAction', '"urn:microsoft-dynamics-schemas/page/integration_posted_sales_invoice:ReadMultiple"');
        String XMLBody = '<Soap:Envelope xmlns:Soap="http://schemas.xmlsoap.org/soap/envelope/">    <Soap:Body>       <ReadMultiple_Result xmlns="urn:microsoft-dynamics-schemas/page/integration_posted_sales_invoice">          <ReadMultiple_Result>             <Integration_Posted_Sales_Invoice>                <Key>32;cAAAAAJ7/1AAUwBJADAAMAAwADAAMQAx10;74298038941;13;SalesInvLines4;44;cQAAAAJ7/1AAUwBJADAAMAAwADAAMQAxAAAAAIcQJw==10;51765836440;44;cQAAAAJ7/1AAUwBJADAAMAAwADAAMQAxAAAAAIcgTg==10;51673323610;44;cQAAAAJ7/1AAUwBJADAAMAAwADAAMQAxAAAAAIcwdQ==10;51722325940;44;cQAAAAJ7/1AAUwBJADAAMAAwADAAMQAxAAAAAIdAnA==10;51746103140;</Key>                <No>PSI000011</No>                <Sell_to_Customer_No>STA201</Sell_to_Customer_No>                <Sell_to_Customer_Name>Stardust Theatrical Dining CC</Sell_to_Customer_Name>                <Sell_to_Address>Main Road 165</Sell_to_Address>                <Sell_to_Address_2>Rondebosch</Sell_to_Address_2>                <Sell_to_Post_Code>7700</Sell_to_Post_Code>                <Sell_to_City>Cape Town</Sell_to_City>                <Sell_to_Contact>Ralze Lie-Paz  / Lionel</Sell_to_Contact>                <Posting_Date>2016-03-01</Posting_Date>                <Document_Date>2016-03-01</Document_Date>                <Document_Exchange_Status>Not_Sent</Document_Exchange_Status>                <Order_No>SO000274</Order_No>                <External_Document_No>HEIN</External_Document_No>                <Salesperson_Code>130</Salesperson_Code>                <Responsibility_Center>CAPE</Responsibility_Center>                <No_Printed>75</No_Printed>                <Print_Trip_Sheet>false</Print_Trip_Sheet>                <DocumentGrossWeight>0</DocumentGrossWeight>                <DocumentVolume>0</DocumentVolume>                <DocumentQuantity>6</DocumentQuantity>                <Bill_to_Customer_No>STA201</Bill_to_Customer_No>                <Bill_to_Name>Stardust Theatrical Dining CC</Bill_to_Name>                <Bill_to_Address>Main Road 165</Bill_to_Address>                <Bill_to_Address_2>Rondebosch</Bill_to_Address_2>                <Bill_to_Post_Code>7700</Bill_to_Post_Code>                <Bill_to_City>Cape Town</Bill_to_City>                <Bill_to_Contact>Ralze Lie-Paz  / Lionel</Bill_to_Contact>                <Shortcut_Dimension_1_Code>1300</Shortcut_Dimension_1_Code>                <Payment_Terms_Code>7DS</Payment_Terms_Code>                <Due_Date>2016-04-07</Due_Date>                <Payment_Discount_Percent>0</Payment_Discount_Percent>                <Pmt_Discount_Date>2016-03-01</Pmt_Discount_Date>                <Prices_Including_VAT>false</Prices_Including_VAT>                <Ship_to_Name>Stardust Theatrical Dining CC</Ship_to_Name>                <Ship_to_Address>Main Road 165</Ship_to_Address>                <Ship_to_Address_2>Rondebosch</Ship_to_Address_2>                <Ship_to_Post_Code>7700</Ship_to_Post_Code>                <Ship_to_City>Cape Town</Ship_to_City>                <Ship_to_Contact>Ralze Lie-Paz  / Lionel</Ship_to_Contact>                <Location_Code>CTN-WHSE</Location_Code>                <Shipment_Method_Code>OWN</Shipment_Method_Code>                <Shipment_Date>2016-03-01</Shipment_Date>                <EU_3_Party_Trade>false</EU_3_Party_Trade>                <SalesInvLines>                   <Web_Posted_Sales_Invoice_Sub>                      <Key>44;cQAAAAJ7/1AAUwBJADAAMAAwADAAMQAxAAAAAIcQJw==10;51765836440;</Key>                      <Type>Item</Type>                      <No>BUBB</No>                      <Variant_Code>2015</Variant_Code>                      <Description>Buitenverwachting Buiten Blanc 2015</Description>                      <Quantity>1</Quantity>                      <Unit_of_Measure_Code>C06X750</Unit_of_Measure_Code>                      <Unit_of_Measure>06 x 750ml</Unit_of_Measure>                      <Unit_Cost_LCY>0</Unit_Cost_LCY>                      <Unit_Price>226.31579</Unit_Price>                      <Line_Amount>203.69</Line_Amount>                      <Line_Discount_Percent>10</Line_Discount_Percent>                      <Line_Discount_Amount>22.63</Line_Discount_Amount>                      <Allow_Invoice_Disc>true</Allow_Invoice_Disc>                      <Appl_to_Item_Entry>0</Appl_to_Item_Entry>                      <Shortcut_Dimension_1_Code>1300</Shortcut_Dimension_1_Code>                      <Sell_to_Customer_No>STA201</Sell_to_Customer_No>                      <Bill_to_Customer_No>STA201</Bill_to_Customer_No>                      <Posting_Date>2016-03-01</Posting_Date>                      <Quantity_Base>6</Quantity_Base>                      <Document_No>PSI000011</Document_No>                      <ItemBarcode>6009640870015</ItemBarcode>                      <Amount>203.69</Amount>                      <Amount_Including_VAT>232.21</Amount_Including_VAT>                      <Invoice_Discount_Amount>0</Invoice_Discount_Amount>                      <Total_Amount_Excl_VAT>1356.63</Total_Amount_Excl_VAT>                      <Total_VAT_Amount>189.93</Total_VAT_Amount>                      <Total_Amount_Incl_VAT>1546.56</Total_Amount_Incl_VAT>                   </Web_Posted_Sales_Invoice_Sub>                   <Web_Posted_Sales_Invoice_Sub>                      <Key>44;cQAAAAJ7/1AAUwBJADAAMAAwADAAMQAxAAAAAIcgTg==10;51673323610;</Key>                      <Type>Item</Type>                      <No>KFPEC</No>                      <Variant_Code>2015</Variant_Code>                      <Description>Ken Forrester Petit Chenin 2015</Description>                      <Quantity>1</Quantity>                      <Unit_of_Measure_Code>C06X750</Unit_of_Measure_Code>                      <Unit_of_Measure>06 x 750ml</Unit_of_Measure>                      <Unit_Cost_LCY>0</Unit_Cost_LCY>                      <Unit_Price>207.36842</Unit_Price>                      <Line_Amount>186.63</Line_Amount>                      <Line_Discount_Percent>10</Line_Discount_Percent>                      <Line_Discount_Amount>20.74</Line_Discount_Amount>                      <Allow_Invoice_Disc>true</Allow_Invoice_Disc>                      <Appl_to_Item_Entry>0</Appl_to_Item_Entry>                      <Shortcut_Dimension_1_Code>1300</Shortcut_Dimension_1_Code>                      <Sell_to_Customer_No>STA201</Sell_to_Customer_No>                      <Bill_to_Customer_No>STA201</Bill_to_Customer_No>                      <Posting_Date>2016-03-01</Posting_Date>                      <Quantity_Base>6</Quantity_Base>                      <Document_No>PSI000011</Document_No>                      <ItemBarcode>6009607660581</ItemBarcode>                      <Amount>186.63</Amount>                      <Amount_Including_VAT>212.76</Amount_Including_VAT>                      <Invoice_Discount_Amount>0</Invoice_Discount_Amount>                      <Total_Amount_Excl_VAT>1356.63</Total_Amount_Excl_VAT>                      <Total_VAT_Amount>189.93</Total_VAT_Amount>                      <Total_Amount_Incl_VAT>1546.56</Total_Amount_Incl_VAT>                   </Web_Posted_Sales_Invoice_Sub>                   <Web_Posted_Sales_Invoice_Sub>                      <Key>44;cQAAAAJ7/1AAUwBJADAAMAAwADAAMQAxAAAAAIcwdQ==10;51722325940;</Key>                      <Type>Item</Type>                      <No>DGRO</No>                      <Variant_Code>2015</Variant_Code>                      <Description>De Grendel Rose 2015</Description>                      <Quantity>2</Quantity>                      <Unit_of_Measure_Code>C06X750</Unit_of_Measure_Code>                      <Unit_of_Measure>06 x 750ml</Unit_of_Measure>                      <Unit_Cost_LCY>0</Unit_Cost_LCY>                      <Unit_Price>234.21053</Unit_Price>                      <Line_Amount>421.58</Line_Amount>                      <Line_Discount_Percent>10</Line_Discount_Percent>                      <Line_Discount_Amount>46.84</Line_Discount_Amount>                      <Allow_Invoice_Disc>true</Allow_Invoice_Disc>                      <Appl_to_Item_Entry>0</Appl_to_Item_Entry>                      <Shortcut_Dimension_1_Code>1300</Shortcut_Dimension_1_Code>                      <Sell_to_Customer_No>STA201</Sell_to_Customer_No>                      <Bill_to_Customer_No>STA201</Bill_to_Customer_No>                      <Posting_Date>2016-03-01</Posting_Date>                      <Quantity_Base>12</Quantity_Base>                      <Document_No>PSI000011</Document_No>                      <ItemBarcode>16009804270115</ItemBarcode>                      <Amount>421.58</Amount>                      <Amount_Including_VAT>480.6</Amount_Including_VAT>                      <Invoice_Discount_Amount>0</Invoice_Discount_Amount>                      <Total_Amount_Excl_VAT>1356.63</Total_Amount_Excl_VAT>                      <Total_VAT_Amount>189.93</Total_VAT_Amount>                      <Total_Amount_Incl_VAT>1546.56</Total_Amount_Incl_VAT>                   </Web_Posted_Sales_Invoice_Sub>                   <Web_Posted_Sales_Invoice_Sub>                      <Key>44;cQAAAAJ7/1AAUwBJADAAMAAwADAAMQAxAAAAAIdAnA==10;51746103140;</Key>                      <Type>Item</Type>                      <No>LMSAB</No>                      <Variant_Code>2015</Variant_Code>                      <Description>La Motte Sauvignon Blanc 2015</Description>                      <Quantity>2</Quantity>                      <Unit_of_Measure_Code>C06X750</Unit_of_Measure_Code>                      <Unit_of_Measure>06 x 750ml</Unit_of_Measure>                      <Unit_Cost_LCY>0</Unit_Cost_LCY>                      <Unit_Price>302.63158</Unit_Price>                      <Line_Amount>544.73</Line_Amount>                      <Line_Discount_Percent>10</Line_Discount_Percent>                      <Line_Discount_Amount>60.53</Line_Discount_Amount>                      <Allow_Invoice_Disc>true</Allow_Invoice_Disc>                      <Appl_to_Item_Entry>0</Appl_to_Item_Entry>                      <Shortcut_Dimension_1_Code>1300</Shortcut_Dimension_1_Code>                      <Sell_to_Customer_No>STA201</Sell_to_Customer_No>                      <Bill_to_Customer_No>STA201</Bill_to_Customer_No>                      <Posting_Date>2016-03-01</Posting_Date>                      <Quantity_Base>12</Quantity_Base>                      <Document_No>PSI000011</Document_No>                      <ItemBarcode>16001497320528</ItemBarcode>                      <Amount>544.73</Amount>                      <Amount_Including_VAT>620.99</Amount_Including_VAT>                      <Invoice_Discount_Amount>0</Invoice_Discount_Amount>                      <Total_Amount_Excl_VAT>1356.63</Total_Amount_Excl_VAT>                      <Total_VAT_Amount>189.93</Total_VAT_Amount>                      <Total_Amount_Incl_VAT>1546.56</Total_Amount_Incl_VAT>                   </Web_Posted_Sales_Invoice_Sub>                </SalesInvLines>             </Integration_Posted_Sales_Invoice>          </ReadMultiple_Result>       </ReadMultiple_Result>    </Soap:Body> </Soap:Envelope>';

        if(responseType == 'Pass'){
            response.setBody(XMLBody);
            response.setStatusCode(200);
        }
        else if(responseType == 'Fail - No Body'){
            response.setBody('{malformed body xxxxx test,}');
        }
        else if(responseType == 'Fail - Internal Error'){
            response.setStatusCode(500);
        }
        return response; 
    }
}