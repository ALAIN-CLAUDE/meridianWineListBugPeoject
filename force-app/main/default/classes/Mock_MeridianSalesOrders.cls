/**=================================================================================================================================
* Created By: Denson Zunga & Tawanda Madavo
* Created Date: 14/01/2021
* Description: Class to handle sales order tests and their mock responses
===================================================================================================================================**/

global class Mock_MeridianSalesOrders implements HttpCalloutMock{

    global String responseType;
    global Mock_MeridianSalesOrders(String responseType){
        this.responseType = responseType;
    }
    // interface method
    global HTTPResponse respond(HTTPRequest request) {
        
        HttpResponse response = new HttpResponse();
        String XMLBody;
        
        XMLBody = '<Soap:Envelope xmlns:Soap="http://schemas.xmlsoap.org/soap/envelope/"><Soap:Body><ReadMultiple_Result xmlns="urn:microsoft-dynamics-schemas/page/integration_sales_order"><ReadMultiple_Result><Integration_Sales_Order><Key>40;JAAAAACLAQAAAAJ7/1MATwA3ADIANAA2ADkANw==10;76959596801;10;SalesLines1;48;JQAAAACLAQAAAAJ7/1MATwA3ADIANAA2ADkANwAAAACHECc=10;76959596470;</Key><No>SO724697</No><Sell_to_Customer_No>A026</Sell_to_Customer_No><Sell_to_Contact_No>16753</Sell_to_Contact_No><Sell_to_Customer_Name>At the Woods Guest House</Sell_to_Customer_Name><Sell_to_Address_2>Po Box 92</Sell_to_Address_2><Sell_to_Post_Code>6348</Sell_to_Post_Code><Sell_to_City>Storms River</Sell_to_City><Sell_to_Contact>Bev Coetzee     </Sell_to_Contact><No_of_Archived_Versions>1</No_of_Archived_Versions><Posting_Date>2021-10-27</Posting_Date><Order_Date>2021-10-27</Order_Date><Document_Date>2021-10-27</Document_Date><Requested_Delivery_Date>0001-01-01</Requested_Delivery_Date><Promised_Delivery_Date>2021-11-04</Promised_Delivery_Date><Salesperson_Code>112</Salesperson_Code><Responsibility_Center>GARDENRT</Responsibility_Center><Job_Queue_Status>_blank_</Job_Queue_Status><Created_By>GROUPMERIDIANCHRIS</Created_By><Status>Released</Status><Bill_to_Customer_No>A026</Bill_to_Customer_No><Bill_to_Contact_No>16753</Bill_to_Contact_No><Bill_to_Name>At the Woods Guest House</Bill_to_Name><Bill_to_Address_2>Po Box 92</Bill_to_Address_2><Bill_to_Post_Code>6348</Bill_to_Post_Code><Bill_to_City>Storms River</Bill_to_City><Bill_to_Contact>Bev Coetzee     </Bill_to_Contact><Shortcut_Dimension_1_Code>1500</Shortcut_Dimension_1_Code><Shortcut_Dimension_2_Code>1801</Shortcut_Dimension_2_Code><Payment_Terms_Code>7D</Payment_Terms_Code><Due_Date>2021-11-03</Due_Date><Payment_Discount_Percent>0</Payment_Discount_Percent><Pmt_Discount_Date>2021-10-27</Pmt_Discount_Date><Prices_Including_VAT>false</Prices_Including_VAT><VAT_Bus_Posting_Group>VAT14</VAT_Bus_Posting_Group><Amount>3913.04</Amount><Amount_Including_VAT>4500</Amount_Including_VAT><Ship_to_Code>A026</Ship_to_Code><Ship_to_Name>At the Woods Guest House</Ship_to_Name><Ship_to_Address_2>Formosa Street 43</Ship_to_Address_2><Ship_to_Post_Code>6308</Ship_to_Post_Code><Ship_to_City>Storms Rivier</Ship_to_City><Route>C3ECONCOUT</Route><Location_Code>CTN-WHSE</Location_Code><Shipment_Method_Code>COURIER</Shipment_Method_Code><Shipping_Time>0D</Shipping_Time><Late_Order_Shipping>true</Late_Order_Shipping><Shipment_Date>2021-10-29</Shipment_Date><Shipping_Advice>Partial</Shipping_Advice><EU_3_Party_Trade>false</EU_3_Party_Trade><Prepayment_Percent>0</Prepayment_Percent><Compress_Prepayment>true</Compress_Prepayment><Prepmt_Payment_Terms_Code>7D</Prepmt_Payment_Terms_Code><Prepayment_Due_Date>2021-11-03</Prepayment_Due_Date><Prepmt_Payment_Discount_Percent>0</Prepmt_Payment_Discount_Percent><Prepmt_Pmt_Discount_Date>2021-10-27</Prepmt_Pmt_Discount_Date><SalesLines><Sales_Order_Subform_Integratio><Key>48;JQAAAACLAQAAAAJ7/1MATwA3ADIANAA2ADkANwAAAACHECc=10;76959596470;</Key><Type>Item</Type><No>LMSAB</No><IC_Partner_Ref_Type>_blank_</IC_Partner_Ref_Type><Variant_Code>2021</Variant_Code><Substitution_Available>false</Substitution_Available><Unit_of_Measure_Code>C06X750</Unit_of_Measure_Code><Nonstock>false</Nonstock><VAT_Prod_Posting_Group>VAT15</VAT_Prod_Posting_Group><Description>La Motte Sauvignon Blanc 2021</Description><Drop_Shipment>false</Drop_Shipment><Special_Order>false</Special_Order><Location_Code>CTN-WHSE</Location_Code><Reserve>Always</Reserve><Quantity>10</Quantity><Qty_to_Assemble_to_Order>0</Qty_to_Assemble_to_Order><Reserved_Quantity>0</Reserved_Quantity><Unit_of_Measure>06 x 750ml</Unit_of_Measure><Unit_Cost_LCY>293.40576</Unit_Cost_LCY><Unit_Price>391.30435</Unit_Price><Line_Amount>3913.04</Line_Amount><Line_Discount_Percent>0</Line_Discount_Percent><Line_Discount_Amount>0</Line_Discount_Amount><Prepayment_Percent>0</Prepayment_Percent><Prepmt_Line_Amount>0</Prepmt_Line_Amount><Prepmt_Amt_Inv>0</Prepmt_Amt_Inv><Allow_Invoice_Disc>false</Allow_Invoice_Disc><Inv_Discount_Amount>0</Inv_Discount_Amount><Qty_to_Ship>0</Qty_to_Ship><Quantity_Shipped>0</Quantity_Shipped><Qty_to_Invoice>0</Qty_to_Invoice><Quantity_Invoiced>0</Quantity_Invoiced><Prepmt_Amt_to_Deduct>0</Prepmt_Amt_to_Deduct><Prepmt_Amt_Deducted>0</Prepmt_Amt_Deducted><Allow_Item_Charge_Assignment>true</Allow_Item_Charge_Assignment><Qty_to_Assign>0</Qty_to_Assign><Qty_Assigned>0</Qty_Assigned><Requested_Delivery_Date>0001-01-01</Requested_Delivery_Date><Promised_Delivery_Date>2021-11-04</Promised_Delivery_Date><Planned_Delivery_Date>2021-11-04</Planned_Delivery_Date><Planned_Shipment_Date>2021-10-29</Planned_Shipment_Date><Shipment_Date>2021-10-29</Shipment_Date><Shipping_Time>0D</Shipping_Time><Whse_Outstanding_Qty>10</Whse_Outstanding_Qty><Whse_Outstanding_Qty_Base>60</Whse_Outstanding_Qty_Base><ATO_Whse_Outstanding_Qty>0</ATO_Whse_Outstanding_Qty><ATO_Whse_Outstd_Qty_Base>0</ATO_Whse_Outstd_Qty_Base><Blanket_Order_Line_No>0</Blanket_Order_Line_No><FA_Posting_Date>0001-01-01</FA_Posting_Date><Depr_until_FA_Posting_Date>false</Depr_until_FA_Posting_Date><Use_Duplication_List>false</Use_Duplication_List><Appl_from_Item_Entry>0</Appl_from_Item_Entry><Appl_to_Item_Entry>0</Appl_to_Item_Entry><Shortcut_Dimension_1_Code>1500</Shortcut_Dimension_1_Code><Shortcut_Dimension_2_Code>1801</Shortcut_Dimension_2_Code><ShortcutDimCode_x005B_3_x005D_>103090</ShortcutDimCode_x005B_3_x005D_><ShortcutDimCode_x005B_4_x005D_>47600</ShortcutDimCode_x005B_4_x005D_><ShortcutDimCode_x005B_5_x005D_>4400</ShortcutDimCode_x005B_5_x005D_><ShortcutDimCode_x005B_6_x005D_>10600</ShortcutDimCode_x005B_6_x005D_><Document_No>SO724697</Document_No><Line_No>10000</Line_No></Sales_Order_Subform_Integratio></SalesLines></Integration_Sales_Order></ReadMultiple_Result></ReadMultiple_Result></Soap:Body></Soap:Envelope>';
        
        response.setHeader('Content-Type', 'application/json');
        if(responseType == 'Pass'){
            response.setBody(XMLBody);
            response.setStatusCode(200);
        }
        else if(responseType == 'Fail - No Body'){
            response.setBody('{malformed body xxxxx test,}');
        }
        else if(responseType == 'Fail - Internal Error'){
            response.setBody(XMLBody);
            response.setStatusCode(500);
        }
        return response; 
    }
}